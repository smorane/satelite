<!DOCTYPE html><html>    <head>        <meta name="viewport" content="initial-scale=1.0, user-scalable=no">        <meta charset="utf-8">        <title>SENAMHI</title>        <style>            html, body, #map-canvas {                height: 100%;                margin: 0px;                padding: 0px            }        </style>        <script type="text/javascript" src="js/jquery-1.8.1.min.js"></script>        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>        <script type="text/javascript" src="ExtDraggableObject.js"></script>        <script>            var overlay;            USGSOverlay.prototype = new google.maps.OverlayView();            var OPACITY_MAX_PIXELS = 57;            var initialOpacity = 40;            var map;            var arrayimg = new Array();            arrayimg.push('PerVISSP201703211845.jpg');                        // Initialize the map and the custom overlay.            function initialize() {                var mapOptions = {                    zoom: 6,                    center: new google.maps.LatLng(-8.4499795, -72.5114395),//-8.166222, -73.455226                    mapTypeId: google.maps.MapTypeId.ROADMAP                };                map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);                //var swBound = new google.maps.LatLng(-19.905683, -86.063872);                //var neBound = new google.maps.LatLng(1.788303, -58.346055);                var swBound = new google.maps.LatLng(-20.200009, -84.994425);                var neBound = new google.maps.LatLng(3.300050, -60.028454);                var bounds = new google.maps.LatLngBounds(swBound, neBound);                //var srcImage = 'PerVISSP201703211845.jpg';                ///overlay = new USGSOverlay(bounds, srcImage, map);                overlay = new USGSOverlay(bounds, arrayimg, map);                createOpacityControl(map, initialOpacity);            }            // [END region_initialization]            // [START region_constructor]            /** @constructor */            function USGSOverlay(bounds, image, map) {                // Initialize all properties.                this.bounds_ = bounds;                this.image_ = image;                this.map_ = map;                this.div_ = null;                this.setMap(map);            }            // [END region_constructor]            // [START region_attachment]            /**             * onAdd is called when the map's panes are ready and the overlay has been             * added to the map.             */            USGSOverlay.prototype.onAdd = function() {                var div = document.createElement('div');                div.style.borderStyle = 'none';                div.style.borderWidth = '0px';                div.style.position = 'absolute';                                $(div).css("-webkit-transform", "skewY(0deg)");                // Create the img element and attach it to the div.                this.div_ = div;                // Add the element to the "overlayLayer" pane.                var panes = this.getPanes();                panes.overlayLayer.appendChild(div);                var img = document.createElement('img');                //img.id = 'imgsatelitale';                img.src = arrayimg[0];                img.style.width = '100%';                img.style.height = '100%';                img.style.position = 'absolute';                div.appendChild(img);                var ini = 0, fin = arrayimg.length, speed = 200;                setInterval(function() {                    if (ini == arrayimg.length)                        ini = 0;                    img.src = arrayimg[ini];                    ini++;                }, speed);            };            // [END region_attachment]            // [START region_drawing]            USGSOverlay.prototype.draw = function() {                //Utilizamos el sur-oeste y norte-este                 //coordenadas de la superposici?n de vincular a la posici?n y el tama?o correctos.                //Para ello, tenemos que recuperar la proyecci?n de la plantilla.                var overlayProjection = this.getProjection();                //Recuperar las coordenadas sur-oeste y al noreste de esta superposici?n                 //en LatLngs y convertirlas en coordenadas de p?xeles                 //Vamos a utilizar estas coordenadas para cambiar el tama?o                 var sw = overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest());                var ne = overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast());                // Cambiar el tama?o de div de la imagen para adaptarse a la indicada                var div = this.div_;                div.style.left = sw.x + 'px';                div.style.top = ne.y + 'px';                div.style.width = (ne.x - sw.x) + 'px';                div.style.height = (sw.y - ne.y) + 'px';            };            // [END region_drawing]            // [START region_removal]            USGSOverlay.prototype.onRemove = function() {                this.div_.parentNode.removeChild(this.div_);                this.div_ = null;            };            // [END region_removal]            USGSOverlay.prototype.setOpacity = function(op) {                this.opacity = op;                var div = this.div_;                //console.log(div);                //transform:rotate(30deg);                if (typeof (div.style.filter) == 'string') {                    div.style.filter = 'alpha(opacity:' + this.opacity + ')';                }                if (typeof (div.style.KHTMLOpacity) == 'string') {                    div.style.KHTMLOpacity = this.opacity / 100;                }                if (typeof (div.style.MozOpacity) == 'string') {                    div.style.MozOpacity = this.opacity / 100;                }                if (typeof (div.style.opacity) == 'string') {                    div.style.opacity = this.opacity / 100;                }            }            google.maps.event.addDomListener(window, 'load', initialize);            function createOpacityControl(map, opacity) {                var sliderImageUrl = "images/opacity-slider3d14.png";                // Create main div to hold the control.                var opacityDiv = document.createElement('DIV');                opacityDiv.setAttribute("style", "margin:5px;overflow-x:hidden;overflow-y:hidden;background:url(" + sliderImageUrl + ") no-repeat;width:71px;height:21px;cursor:pointer;");                // Create knob                var opacityKnobDiv = document.createElement('DIV');                opacityKnobDiv.setAttribute("style", "padding:0;margin:0;overflow-x:hidden;overflow-y:hidden;background:url(" + sliderImageUrl + ") no-repeat -71px 0;width:14px;height:21px;");                opacityDiv.appendChild(opacityKnobDiv);                var opacityCtrlKnob = new ExtDraggableObject(opacityKnobDiv, {                    restrictY: true,                    container: opacityDiv                });                google.maps.event.addListener(opacityCtrlKnob, "dragend", function() {                    setOpacity(opacityCtrlKnob.valueX());                });                google.maps.event.addDomListener(opacityDiv, "click", function(e) {                    var left = findPosLeft(this);                    var x = e.pageX - left - 5; // - 5 as we're using a margin of 5px on the div                    opacityCtrlKnob.setValueX(x);                    setOpacity(x);                });                map.controls[google.maps.ControlPosition.TOP_RIGHT].push(opacityDiv);                // Set initial value                var initialValue = OPACITY_MAX_PIXELS / (100 / opacity);                opacityCtrlKnob.setValueX(initialValue);                setOpacity(initialValue);            }            function setOpacity(pixelX) {                // Range = 0 to OPACITY_MAX_PIXELS                var value = (100 / OPACITY_MAX_PIXELS) * pixelX;                console.log(value);                //console.log(this.div_);                overlay.setOpacity(value);                /*                 if (value < 0) value = 0;                 if (value == 0) {                 if (overlay.visible == true) {                 overlay.hide();                 }                 }                 else {                 overlay.setOpacity(value);                 if (overlay.visible == false) {                 overlay.show();                 }                 }*/            }            function findPosLeft(obj) {                var curleft = 0;                if (obj.offsetParent) {                    do {                        curleft += obj.offsetLeft;                    } while (obj = obj.offsetParent);                    return curleft;                }                return undefined;            }        </script>    </head>    <body>        <div id="map-canvas"></div>    </body></html>